<!--pages/history/history.wxml-->
<view class="container">
  <!-- 头部 -->
  <view class="header">
    <text class="title">历史记录</text>
    <text class="subtitle">您制作过的证件照</text>
  </view>

  <!-- 历史列表 -->
  <view class="history-list" wx:if="{{historyList.length > 0}}">
    <block wx:for="{{historyList}}" wx:key="id">
      <view class="history-card fade-in" style="animation-delay: {{index * 0.05}}s;" bindtap="viewHistory" data-item="{{item}}">
        <view class="history-preview">
          <image class="preview-image" src="{{item.processedImages.standard}}" mode="aspectFill"></image>
        </view>
        <view class="history-info">
          <text class="history-name">{{item.photoType.name}}</text>
          <text class="history-time">{{item.timeText}}</text>
          <view class="history-tags">
            <text class="tag">{{item.photoType.width}}×{{item.photoType.height}}</text>
            <text class="tag" wx:if="{{item.backgroundColor}}">已上色</text>
          </view>
        </view>
        <view class="history-actions" catchtap="deleteHistory" data-id="{{item.id}}">
          <text class="delete-icon">🗑️</text>
        </view>
      </view>
    </block>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:else>
    <text class="empty-icon">📸</text>
    <text class="empty-text">还没有历史记录</text>
    <text class="empty-hint">制作证件照后会自动保存在这里</text>
    <button class="btn btn-primary empty-btn" bindtap="goToIndex">
      <text>开始制作</text>
    </button>
  </view>

  <!-- 清空按钮 -->
  <view class="clear-section" wx:if="{{historyList.length > 0}}">
    <button class="btn btn-outline clear-btn" bindtap="clearAll">
      <text>🗑️ 清空历史</text>
    </button>
  </view>
</view>
